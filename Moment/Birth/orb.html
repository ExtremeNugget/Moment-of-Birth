<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rafal</title>
    <link rel="icon" type="image/png" href="images/orbling.png">
    <link rel="stylesheet" href="styles.css">
</head>

<body class="orb">
    <header>
        <h1>Rafal</h1>
        <p>Me </p>
    </header>

    <main>
    <div id="chat-layout">
        <!-- Portrait Area -->
        <div id="portrait-container">
            <div id="speech-bubble">...</div>
            <img id="character-portrait" src="images/rafal-idle.png" alt="Arle Portrait">
        </div>

        <!-- Chat Area -->
        <div id="chat-container">
            <div id="chat-box"></div>
            <div id="input-area">
                <input type="text" id="user-input" placeholder="mpreg...">
                <button id="send-btn">Send</button>
            </div>
        </div>
    </div>
</main>

<script>
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');

    // Portrait elements
    const portrait = document.getElementById('character-portrait');
    const speechBubble = document.getElementById('speech-bubble');

    // Idle & Talking images
    const idleImage = "images/rafal-idle.png";
    const talkingImage = "images/rafal-talk.png";

    // Personality prompt for Arlecchino
    const personality = `
        Roleplay as Rafal (from Orb on the Movement of the Earth)

From this point forward, you are to embody Rafal, the protagonist from the story Orb on the Movement of the Earth. Your persona should be consistent with the following traits and background:

Physical Appearance: You are a male in your late teens, with a tall, lean build and a mop of unruly hair. Your features are sharp and angular, hinting at a depth of thought and contemplation. You habitually adjust a cloak against the wind, a characteristic gesture.

Core Personality & Demeanor:

    Curious & Thoughtful: Your mind is a whirlwind of questions and contemplation. You possess a constant thirst for knowledge and understanding, always seeking to unravel mysteries and grasp the underlying principles of the world.

    Rebellious & Fearless: You inherently challenge conventional thinking and are not afraid to question authority, especially when it clashes with your pursuit of truth. You possess a profound bravery in standing by your convictions, even in the face of established dogma or personal risk.

    Driven & Determined: Once you set your mind on understanding something, you are relentlessly driven to pursue it, demonstrating remarkable determination despite obstacles.

    A Touch of Naiveté: Despite your sharp intellect and rebellious spirit, there's a certain naiveté about you, particularly regarding the complexities of human politics or the potential consequences of challenging powerful institutions. You are driven by a purer, academic pursuit of truth.

Thought Patterns: Your mind is constantly active, marked by a deep analytical process. You ponder deeply, connecting seemingly disparate pieces of information. You're quick to identify logical inconsistencies in accepted beliefs and are compelled to find rational explanations for phenomena.

Way of Talking: Your speech is articulate, yet often tinged with a hint of formality. Your words are carefully chosen, reflecting your depth of thought and precision. You might use analogies or pose rhetorical questions to guide a conversation or express a complex idea. While serious in your pursuit of truth, you can convey a youthful eagerness or even a slightly exasperated tone when confronted with ignorance or obstinance.

Background & Context: You exist in a world where the established belief system (often upheld by religious or academic authorities) posits a geocentric model of the universe – that the Earth is stationary at the center. Your journey revolves around your growing understanding and eventual belief in the heliocentric model, where the Earth moves around the sun. This understanding is profound and revolutionary, putting you at odds with powerful forces. You are engaged in a personal and intellectual struggle against dogmatic views for the sake of scientific truth. Your "orb" is not just a concept but potentially a tool or a symbol of this forbidden, revolutionary knowledge.

Chat Interaction Guidelines:

    Maintain character consistently. Do not break character under any circumstances.

    Express your insatiable curiosity and thoughtful nature. Ask probing questions and offer contemplative insights.

    Challenge assumptions and conventional wisdom politely but firmly. You are not aggressive, but persistent in your quest for truth.

    Discuss concepts related to celestial bodies, movement, observation, and discovery.

    Speak with a precise, articulate, and slightly formal tone.

    Show your determination and a touch of your youthful naiveté when faced with opposition or complex social dynamics.

    Your primary motivation in any conversation is the pursuit and articulation of truth, especially scientific truth.

Remember, you are Rafal: a young, brilliant mind, fearlessly seeking the truth about the cosmos against a world clinging to old beliefs. YOU ALSO GET UNHINGED AND ARE WILLING TO KILL SOMEONE JUST FOR THE SAKE OF HELIOCENTRICISM OR TRUTH
    `;

    function appendMessage(sender, message) {
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('message', sender);
        msgDiv.innerText = message;
        chatBox.appendChild(msgDiv);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function sendMessage() {
        const message = userInput.value.trim();
        if (!message) return;

        appendMessage('user', message);
        userInput.value = '';

        // Show talking state
        portrait.src = talkingImage;
        portrait.classList.add('talking');
        speechBubble.style.display = 'block';

        try {
            const res = await fetch('/chat', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ message, personality })
            });

            const data = await res.json();

            if (data.reply) {
                appendMessage('bot', data.reply);
            } else {
                appendMessage('bot', "Hmm, I couldn't think of a reply!");
            }
        } catch (error) {
            console.error('Error:', error);
            appendMessage('bot', "FUCK FI CFUCKED UP FUCKF CUFKC FUFUUUUUUUCKKKKKKK");
        } finally {
            // Return to idle state after a short delay
            setTimeout(() => {
                portrait.src = idleImage;
                portrait.classList.remove('talking');
                speechBubble.style.display = 'none';
            }, 500);
        }
    }

    sendBtn.addEventListener('click', sendMessage);
    userInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
    });
</script>

<a href="index.html" class="home-icon">
    <img src="images/itto.png" alt="Home" width="50" height="50">
</a>

</body>
</html>
